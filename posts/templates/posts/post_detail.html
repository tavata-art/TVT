{% extends 'core/base.html' %}
{% load i18n %}

{# SEO Tags #}
{% block seo_title %}{{ post.meta_title|default:post.title }}{% endblock %}
{% block seo_description %}{{ post.meta_description|default:"" }}{% endblock %}
{% block title %}{{ post.title }}{% endblock %}

{# üß≠ Breadcrumbs #}
{% block breadcrumbs %}
  {% include "core/partials/_breadcrumbs.html" %}
{% endblock %}

{% block content %}
<div class="container mt-5">
  <article class="post">
    <header class="mb-4">
      <h1 class="display-5">{{ post.title }}</h1>
      <p class="text-muted">
        {{ post.published_date|date:"DATE_FORMAT" }} ¬∑ {{ post.author.get_full_name|default:post.author.username }}
      </p>
    </header>

    {% if post.featured_image %}
      <img src="{{ post.featured_image.url }}" class="img-fluid mb-4" alt="{{ post.title }}">
    {% endif %}
    
    {# üè∑Ô∏è TAGS as Badges #}
    {% if post.tags.exists %}
      <div class="post-tags mt-4">
        <h6 class="text-muted">{% trans "Tags" %}:</h6>
        <ul class="list-inline">
          {% for tag in post.tags.all %}
            <li class="list-inline-item">
              <a href="{% url 'posts:posts_by_tag' tag.slug %}" class="badge bg-secondary text-decoration-none">
                {{ tag.label }}
              </a>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
    <div class="post-content mb-5">
      {{ post.content|safe }}
    </div>
    <hr>
    <h4>{% trans "Leave a comment" %}</h4>

    {% if comment_submitted %}
      <div class="alert alert-success">
        {% trans "Your comment has been submitted and is awaiting moderation." %}
      </div>
    {% else %}
      <form method="post" class="mb-5">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <button type="submit" class="btn btn-primary">{% trans "Submit Comment" %}</button>
      </form>
    {% endif %}

    {% if comments %}
      <div class="mt-5">
        <h4>{% trans "Comments" %}</h4>
        <ul class="list-group">
          {% for comment in comments %}
            <li class="list-group-item">
              <strong>{{ comment.get_author_name }}</strong>
              <small class="text-muted">‚Äì {{ comment.created_at|date:"SHORT_DATETIME_FORMAT" }}</small>
              <p class="mb-0">{{ comment.content }}</p>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  </article>
</div>
{% endblock %}
